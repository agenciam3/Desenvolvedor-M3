"use strict";import Generic from"../core/Generic.js";import ProductsView from"./ProductsView.js";import SizesBoxes from"./SizesBoxes.js";var cart_itens=[],__initialized=!1,__icon_callback=()=>{},__cart_icon_container="",changeIconInfo__allow_ADDEVENTLISTENER=!0;function getHeaderIconHTML(e=0){return`<div class="shopping-cart-icon-container" id="shopping-cart-icon-container-id">\n                <img src="./images/shopping-bag.svg">\n                <div class="synalyzer-container">\n                    <label>${e}</label>\n                </div>\n            </div>`}function changeIconInfo(e,n=""){n&&(__cart_icon_container=n),n=Generic().exists_id_on_document(__cart_icon_container);let i=Generic().exists_id_on_document("shopping-cart-close-button");if(n.innerHTML=getHeaderIconHTML(e),n&&i){changeIconInfo__allow_ADDEVENTLISTENER&&(changeIconInfo__allow_ADDEVENTLISTENER=!changeIconInfo__allow_ADDEVENTLISTENER,n.addEventListener("click",e=>{showOrHideCart()}),i.addEventListener("click",e=>{showOrHideCart()}));let t=n.getElementsByTagName("label")[0];t&&(t.innerText=e)}else console.log("Erro ao adicionar o listener para o filtro de ordenação.")}function createCart(){document.body.innerHTML+='\n        <div class="shopping-cart-backdrop closed" id="shopping-cart-backdrop-id"></div>\n        <div class="shopping-cart closed" id="shopping-cart-id">\n            <div class="container">\n                <div class="info-container">\n                    <div class="heading">\n                        <label class="info-title">Carrinho de compras</label>\n                        <img src="./images/cancel.svg" id="shopping-cart-close-button">\n                    </div>\n                    <div class="itens-list">\n                    </div>\n                    <div class="info">\n                        <button class="show-more-blue">Finalizar Compra</button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    '}function getCartItemHTML(e){return`\n        <div class="shop-cart-item">\n            <img src="${e.image}">\n            <div class="subdivision">\n            <label>${e.name}</label>\n            <label>R$${e.price.toFixed(2)} ou 3x de ${e.division_price.toFixed(2)}</label>\n            <label>Tamanho escolhido: ${e.size_choosed}</label>\n            </div>\n            <img src="./images/remove.svg" class="close-btn" data-product="${e.id}">\n        </div>\n    `}function updateVisualItensOnCartContainer(){let e=Generic().exists_id_on_document("shopping-cart-id");if(e){let n=e.getElementsByClassName("itens-list")[0],i=e.getElementsByClassName("info-container")[0];n.innerHTML="";let t=0;cart_itens.forEach(e=>{n.innerHTML+=getCartItemHTML(e),t+=e.price});let a=i.getElementsByClassName("close-btn");for(let e=0;e<a.length;e++)a[e].addEventListener("click",()=>{removeItem(a[e].dataset.product,()=>{ProductsView().create()}),console.log("updated?")});let o=i.getElementsByTagName("label")[0];o&&(0==cart_itens.length?(n.innerHTML='<p class="no-itens">Nenhum item adicionado.</p>\'',o.innerText="Carrinho de compras"):o.innerText=`Suas compras totalizaram R$${t}`)}}function addItem(e,n=(()=>{})){let i;cart_itens.forEach(n=>{n.id==e.id&&(i=e)}),i?removeItem(e.id,n):(cart_itens.push(e),changeIconInfo(cart_itens.length),updateVisualItensOnCartContainer(),n())}function removeItem(e="",n=(()=>{})){changeIconInfo((cart_itens=cart_itens.filter(n=>n.id!==e)).length),updateVisualItensOnCartContainer(),n()}function showOrHideCart(){let e=Generic().exists_id_on_document("shopping-cart-id"),n=Generic().exists_id_on_document("shopping-cart-backdrop-id");e&&n?e.classList.contains("opened")?(e.classList.add("closed"),e.classList.remove("opened"),n.classList.add("closed"),n.classList.remove("opened")):(e.classList.add("opened"),e.classList.remove("closed"),n.classList.add("opened"),n.classList.remove("closed")):console.log("MUDOU NADA!")}export default function ShopCart(){return __initialized||(createCart(),__initialized=!0),{create(e=""){changeIconInfo(0,e)},addItem(e,n=(()=>{})){addItem(e,n)},removeItem(e="",n=(()=>{})){removeItem("",n)},getCartItens:()=>cart_itens}}