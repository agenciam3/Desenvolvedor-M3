"use strict";var PRODUCTS_DATA=[],LAST_FILTER={},LAST_FILTERED=[];function generateID(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==r?t:3&t|8).toString(16)})}function randomPrice(e,r){return Math.floor(Math.random()*(r-e+1)+e)}function divideUpTo3x(e){return parseFloat((e/3).toFixed(2))}function randomSize(){let e=["P","M","G","GG","U","36","38","40","42","44","46"],r=[];for(let t=0;t<2;t++)r.push(e[Math.floor(Math.random()*e.length)]);return r}function fillData(e={products:[{image:null,color:[],price:[],name:null}]}){if(!PRODUCTS_DATA.length)for(;PRODUCTS_DATA.length<250;){let r=e.products[Math.floor(Math.random()*e.products.length)],t=randomPrice(r.price[0],r.price[1]),n={id:generateID(),image:r.image,price:t,name:r.name,color:r.color,sizes:randomSize(),division_price:divideUpTo3x(t),creation_date:new Date};PRODUCTS_DATA.push(n)}}function applyFilters(e={colors_name:[],sizes:[],price_range:[],orderBy:"cheapest"}){let r=[];if(e.colors_name.length>0?PRODUCTS_DATA.forEach(t=>{let n=!1;t.color.map(i=>{e.colors_name.map(e=>{n||i!=e||(r.push(t),n=!0)})})}):r=PRODUCTS_DATA,e.sizes.length>0){let t=[];r.forEach(r=>{let n=!1;r.sizes.map(i=>{e.sizes.map(e=>{n||i!=e||(t.push(r),n=!0)})})}),r=t}if(e.price_range.length>0){let t=[];r.forEach(r=>{r.price>=e.price_range[0]&&r.price<=e.price_range[1]&&t.push(r)}),r=t}return r.sort((r,t)=>"cheapest"==e.orderBy?r.price>t.price?1:-1:"expensive"==e.orderBy?r.price<t.price?1:-1:"recent"==e.orderBy?r.creation_date<t.creation_date?1:-1:void 0),LAST_FILTER=e,LAST_FILTERED=r,r}function applyPagination(e=0,r=10,t=[]){let n=e+r,i=!0;return n>=t.length&&(i=!1,n=t.length),t.length>=e&&n<=t.length?{data:t.slice(e,n),pagination:{total_without_filters:PRODUCTS_DATA.length,total_filtered:t.length,range_start:e,final_range:n,hasMorePages:i}}:null}function extractExtraInfo(){let e={cheapest_price:1e7,expensive_price:0,unique_colors:[],unique_sizes:[]};return LAST_FILTERED.forEach(r=>{r.price>e.expensive_price&&(e.expensive_price=r.price),r.price<e.cheapest_price&&(e.cheapest_price=r.price),r.color.map(r=>{e.unique_colors.includes(r)||e.unique_colors.push(r)}),r.sizes.map(r=>{e.unique_sizes.includes(r)||e.unique_sizes.push(r)}),e.unique_colors.sort(),e.unique_sizes.sort()}),e}export default function showcase(e,r,t={colors_name:[],sizes:[],price_range:[],orderBy:"recent"}){return new Promise((n,i)=>{try{var o=new XMLHttpRequest;o.open("GET","./js/ASP/data/products.json",!1),o.send(null),fillData(JSON.parse(o.responseText));let a=applyFilters(t),c=applyPagination(e,r,a),s=extractExtraInfo();c.extra=s,n(c)}catch(e){console.log("Erro ao ler o arquivo JSON! Segue o erro abaixo:",e),i(e)}})}