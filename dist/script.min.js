"use strict";var initialIndex,finalIndex,mobileColors=document.querySelector("div.mobile-colors"),mobileSizes=document.querySelector("div.mobile-sizes"),mobilePriceRanges=document.querySelector("div.mobile-price-ranges"),colors=document.querySelectorAll("div.color"),sizes=document.querySelectorAll("div.size"),priceRanges=document.querySelectorAll("div.price-range"),closeMobileFilter=document.getElementById("close-mobile-filter"),main=document.querySelector("main"),loadMoreProducts=document.createElement("button");loadMoreProducts.setAttribute("id","load-more-products"),loadMoreProducts.textContent="CARREGAR MAIS";var productsNotFound=document.createElement("p");function showOtherColors(){var e=document.getElementById("more-colors"),t=document.querySelector("div.other-colors");e.onclick=function(){"hidden-colors"===t.getAttribute("id")?(t.setAttribute("id","showed-colors"),e.textContent="Ver menos cores ▴"):(t.setAttribute("id","hidden-colors"),e.textContent="Ver todas as cores ▾")}}function showOrderingOptions(){var t=document.getElementById("desktop-ordering"),o=document.querySelector("div.ordering-options");t.onclick=function(){o.setAttribute("id","ordering-showed-options")},document.onclick=function(e){e.target!==t&&o.setAttribute("id","ordering-hidden-options")}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}function setAplyFilters(){document.querySelectorAll("button.filter-aply").forEach(function(e){e.onclick=function(){var t=_toConsumableArray(document.querySelectorAll("div.check-color.checked")).map(function(e){return e.getAttribute("id")}),e=_toConsumableArray(document.querySelectorAll("label.color")).filter(function(e){return t.includes(e.getAttribute("for"))}).map(function(e){return e.textContent}),o=_toConsumableArray(document.querySelectorAll("div.selected")).map(function(e){return e.textContent}),n=_toConsumableArray(document.querySelectorAll("div.check-price-range.checked")).map(function(e){return e.getAttribute("id")}),r=_toConsumableArray(document.querySelectorAll("label.price-range")).filter(function(e){return n.includes(e.getAttribute("for"))}).map(function(e){return e.textContent}),i=/\d+/g,c=[];r.forEach(function(e){e.match(i).forEach(function(e){return c.push(e)})});var l=[];if(r.find(function(e){return e.includes("a partir de")})?(1<c.length&&(l.push(Number(c.shift())),l.push(Number(c[c.length-2]))),l.push(Number(c.pop()))):0<r.length&&(l.push(Number(c.shift())),l.push(Number(c.pop()))),0<e.length||0<o.length||0<l.length){var d={colors:e,sizes:o,priceRange:l};document.querySelectorAll("div.product").forEach(function(e){return main.removeChild(e)}),loadMoreProducts.remove(),initialIndex=0,finalIndex=9,setLoadMore(d),getProducts(initialIndex,finalIndex,d),closeMobileFilter.click()}}})}function setCleanFilters(){document.querySelectorAll("button.filter-clean").forEach(function(e){e.onclick=function(){var e=document.querySelectorAll("div.checked"),t=document.querySelectorAll("div.selected");e.forEach(function(e){return e.classList.remove("checked")}),t.forEach(function(e){return e.classList.remove("selected")}),showInitialProducts(),closeMobileFilter.click()}})}function setToggleCheckbox(){document.querySelectorAll("div.checkbox").forEach(function(e){e.onclick=function(){this.classList.contains("checked")?this.classList.remove("checked"):this.classList.add("checked")}})}function setToggleSize(){document.querySelectorAll("div.size").forEach(function(e){e.onclick=function(){this.classList.contains("selected")?this.classList.remove("selected"):this.classList.add("selected")}})}function shareFilterInputs(){var o=document.getElementById("desktop-colors"),n=document.querySelector("div.other-colors"),t=document.getElementById("desktop-sizes"),r=document.getElementById("desktop-price-ranges");document.body.onresize=function(){790<=window.innerWidth?(colors.forEach(function(e,t){t<5?o.insertBefore(e,n):n.appendChild(e)}),sizes.forEach(function(e){return t.appendChild(e)}),priceRanges.forEach(function(e){return r.appendChild(e)})):(colors.forEach(function(e){return mobileColors.appendChild(e)}),sizes.forEach(function(e){return mobileSizes.appendChild(e)}),priceRanges.forEach(function(e){return mobilePriceRanges.appendChild(e)}))}}function setFilterMenu(){var e=document.getElementById("mobile-menu-filter-option"),t=document.querySelector("div.mobile-filter");e.onclick=function(){t.setAttribute("id","mobile-filter-showed"),document.body.style.overflow="hidden"},closeMobileFilter.onclick=function(){t.setAttribute("id","mobile-filter-hidden"),document.body.style.overflow="auto"}}function setColorsOption(){document.getElementById("expand-mobile-colors").onclick=function(){"mobile-colors-hidden"===mobileColors.getAttribute("id")?(colors.forEach(function(e){return mobileColors.appendChild(e)}),mobileColors.setAttribute("id","mobile-colors-showed"),this.textContent="–"):(mobileColors.setAttribute("id","mobile-colors-hidden"),this.textContent="+")}}function setSizesOption(){document.getElementById("expand-mobile-sizes").onclick=function(){"mobile-sizes-hidden"===mobileSizes.getAttribute("id")?(sizes.forEach(function(e){return mobileSizes.appendChild(e)}),mobileSizes.setAttribute("id","mobile-sizes-showed"),this.textContent="–"):(mobileSizes.setAttribute("id","mobile-sizes-hidden"),this.textContent="+")}}function setPriceRangesOption(){document.getElementById("expand-mobile-price-ranges").onclick=function(){"mobile-price-ranges-hidden"===mobilePriceRanges.getAttribute("id")?(priceRanges.forEach(function(e){return mobilePriceRanges.appendChild(e)}),mobilePriceRanges.setAttribute("id","mobile-price-ranges-showed"),this.textContent="–"):(mobilePriceRanges.setAttribute("id","mobile-price-ranges-hidden"),this.textContent="+")}}function setOrderingMenu(){var e=document.getElementById("mobile-menu-ordering-option"),t=document.querySelector("div.mobile-ordering"),o=document.getElementById("close-mobile-ordering");e.onclick=function(){t.setAttribute("id","mobile-ordering-showed"),document.body.style.overflow="hidden"},o.onclick=function(){t.setAttribute("id","mobile-ordering-hidden"),document.body.style.overflow="auto"}}function showInitialProducts(){document.querySelectorAll("div.product").forEach(function(e){return main.removeChild(e)}),getProducts(initialIndex=0,finalIndex=9),setLoadMore()}function getProducts(o,n,r){fetch("http://localhost:5555/products").then(function(e){return e.json()}).then(function(e){if(r){var t=filterProducts(e,r);(o<t.length||0===t.length)&&renderProducts(t.slice(o,n))}else o<e.length&&renderProducts(e.slice(o,n))}).catch(function(e){return console.error("Erro ao buscar os produtos a serem renderizados.\nError: ".concat(e))})}function filterProducts(e,r){return e.filter(function(e){var t=!0,o=!0,n=!0;return 0<r.colors.length&&(t=r.colors.includes(e.color)),0<r.sizes.length&&(o=!!e.size.find(function(e){return r.sizes.includes(e)})),1===r.priceRange.length?n=e.price>r.priceRange[0]:2===r.priceRange.length?n=e.price>=r.priceRange[0]&&e.price<=r.priceRange[1]:3===r.priceRange.length&&(n=e.price>=r.priceRange[0]&&e.price<=r.priceRange[1]||e.price>r.priceRange[2]),t&&o&&n})}function renderProducts(e){0<e.length?(e.forEach(function(e){var t=document.createElement("div"),o=document.createElement("img"),n=document.createElement("p"),r=document.createElement("p"),i=document.createElement("p"),c=document.createElement("button"),l=250<e.price?5:3;t.setAttribute("class","product"),o.setAttribute("src",e.image),n.setAttribute("id","product-name"),n.textContent=e.name,r.setAttribute("id","product-price"),r.textContent="R$ ".concat(e.price.toLocaleString("pt-br",{minimumFractionDigits:2,maximumFractionDigits:2})),i.textContent="em até ".concat(l,"x de ").concat((e.price/l).toLocaleString("pt-br",{minimumFractionDigits:2,maximumFractionDigits:2})),c.setAttribute("class","buy-product"),c.setAttribute("product-id",e.id),c.textContent="COMPRAR",c.onclick=function(){findProduct(this.getAttribute("product-id"))},t.appendChild(o),t.appendChild(n),t.appendChild(r),t.appendChild(i),t.appendChild(c),main.appendChild(t)}),main.appendChild(loadMoreProducts),productsNotFound.remove()):main.appendChild(productsNotFound)}function setLoadMore(e){loadMoreProducts.onclick=function(){getProducts(initialIndex=finalIndex,finalIndex+=6,e)}}function findProduct(e){var t="http://localhost:5555/products?id=".concat(e);fetch(t).then(function(e){return e.json()}).then(function(e){addToBag(e[0])}).catch(function(e){return console.error("Erro ao buscar o produto para adição ao carrinho.\nError: ".concat(e))})}function addToBag(e){fetch("http://localhost:5555/bag-items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){if(201!==e.status)throw Error;console.info("Produto adicionado ao carrinho.")}).catch(function(e){console.error("Erro ao adicionar o produto ao carrinho."),alert("Este produto já foi adicionado ao carrinho.")}),updateBag()}function updateBag(){fetch("http://localhost:5555/bag-items").then(function(e){return e.json()}).then(function(e){var t=document.getElementById("bag-items"),o=e.length;t.textContent=o})}productsNotFound.setAttribute("id","products-not-found"),productsNotFound.textContent="Produtos não encontrados",showOtherColors(),showOrderingOptions(),setAplyFilters(),setCleanFilters(),setToggleCheckbox(),setToggleSize(),shareFilterInputs(),setFilterMenu(),setColorsOption(),setSizesOption(),setPriceRangesOption(),setOrderingMenu(),showInitialProducts(),updateBag();